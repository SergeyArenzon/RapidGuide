# Development Dockerfile for hot reloading
FROM node:24-alpine

# Install pnpm
RUN npm install -g pnpm

WORKDIR /app

# Copy workspace files
COPY pnpm-lock.yaml pnpm-workspace.yaml package.json ./
COPY services/tour/package.json ./services/tour/
COPY services/tour/tsconfig.json services/tour/tsconfig.build.json services/tour/nest-cli.json ./services/tour/
COPY shared ./shared

# Install dependencies using workspace
RUN pnpm install --filter ./services/tour... --frozen-lockfile

# Copy the source code
COPY services/tour/src/ ./services/tour/src/


# Set working directory to the service
WORKDIR /app/services/tour

# Expose port
EXPOSE 3000

# Start in development mode with hot reloading
CMD ["pnpm", "run", "start:dev"]

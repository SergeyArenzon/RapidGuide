# Development Dockerfile for hot reloading
FROM node:24-alpine

# Install pnpm
RUN npm install -g pnpm

WORKDIR /app

# Copy workspace files
COPY pnpm-workspace.yaml package.json pnpm-lock.yaml ./

# Copy package files
COPY services/tour/package.json ./package.json
COPY services/tour/tsconfig.json tsconfig.json
COPY services/tour/tsconfig.build.json tsconfig.build.json
COPY services/tour/nest-cli.json nest-cli.json

# Copy shared packages
COPY shared/ ./shared/

# Install all dependencies (including dev dependencies)
RUN pnpm install

# Copy the source code
COPY services/tour/src/ ./src/

# Expose port
EXPOSE 3000

# Start in development mode with hot reloading
CMD ["pnpm", "run", "start:dev"]
